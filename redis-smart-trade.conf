# üî¥ Redis Configuration for Smart-Trade
# Configura√ß√£o otimizada para trading em tempo real

# === NETWORK ===
bind 127.0.0.1
port 6379
timeout 0
tcp-keepalive 300

# === GENERAL ===
daemonize yes
pidfile /var/run/redis/redis-server.pid
loglevel notice
logfile /var/log/redis/redis-server.log

# === MEMORY MANAGEMENT ===
# Limite de mem√≥ria para dados de trading (512MB)
maxmemory 512mb
maxmemory-policy allkeys-lru

# === PERSISTENCE ===
# Configura√ß√£o para dados de trading (menos persist√™ncia, mais performance)
save 900 1
save 300 10
save 60 10000

# Desabilitar RDB para m√°xima performance (dados s√£o tempor√°rios)
# save ""

# AOF para dados cr√≠ticos
appendonly yes
appendfilename "appendonly.aof"
appendfsync everysec
no-appendfsync-on-rewrite no
auto-aof-rewrite-percentage 100
auto-aof-rewrite-min-size 64mb

# === PERFORMANCE ===
# Otimiza√ß√µes para trading em tempo real
tcp-backlog 511
databases 16

# Hash otimiza√ß√µes
hash-max-ziplist-entries 512
hash-max-ziplist-value 64

# List otimiza√ß√µes
list-max-ziplist-size -2
list-compress-depth 0

# Set otimiza√ß√µes
set-max-intset-entries 512

# ZSet otimiza√ß√µes
zset-max-ziplist-entries 128
zset-max-ziplist-value 64

# === SLOW LOG ===
slowlog-log-slower-than 10000
slowlog-max-len 128

# === LATENCY ===
latency-monitor-threshold 100

# === CLIENT ===
# M√°ximo de clientes conectados
maxclients 10000

# === SECURITY ===
# Desabilitar comandos perigosos
rename-command FLUSHDB ""
rename-command FLUSHALL ""
rename-command KEYS ""
rename-command CONFIG ""

# === MODULES ===
# Carregar m√≥dulos se necess√°rio
# loadmodule /path/to/module.so

# === SMART-TRADE SPECIFIC ===
# Configura√ß√µes espec√≠ficas para dados de trading

# Database 0: Quotes em tempo real (TTL curto)
# Database 1: Order Flow data (TTL m√©dio)
# Database 2: Footprint data (TTL m√©dio)
# Database 3: Cache de c√°lculos (TTL longo)
# Database 4: Sess√µes WebSocket
# Database 5: Configura√ß√µes do usu√°rio

# === MONITORING ===
# Habilitar estat√≠sticas
info-refresh-interval 1

# === REPLICATION ===
# Configura√ß√µes para replica√ß√£o (futuro)
# replicaof <masterip> <masterport>
# replica-read-only yes

# === CLUSTER ===
# Configura√ß√µes para cluster (futuro)
# cluster-enabled yes
# cluster-config-file nodes-6379.conf
# cluster-node-timeout 15000

# === NOTIFICATIONS ===
# Notifica√ß√µes de eventos para o Smart-Trade
notify-keyspace-events "Ex"

# === MEMORY OPTIMIZATION ===
# Otimiza√ß√µes de mem√≥ria para dados de trading
activerehashing yes
client-output-buffer-limit normal 0 0 0
client-output-buffer-limit replica 256mb 64mb 60
client-output-buffer-limit pubsub 32mb 8mb 60

# === THREADING ===
# Threading para I/O (Redis 6+)
# io-threads 4
# io-threads-do-reads yes

# === SMART-TRADE COMMENTS ===
# Esta configura√ß√£o √© otimizada para:
# 1. Baixa lat√™ncia para dados de trading
# 2. Cache eficiente de quotes e order flow
# 3. Persist√™ncia m√≠nima para m√°xima performance
# 4. Monitoramento de performance
# 5. Seguran√ßa b√°sica

# Para produ√ß√£o, considere:
# 1. Configurar senha: requirepass your-password
# 2. Configurar SSL/TLS
# 3. Configurar backup autom√°tico
# 4. Configurar monitoramento avan√ßado
